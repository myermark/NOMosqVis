91/216
if(!require(httr)) install.packages('httr')
url <- "https://github.com/famuvie/2016_RisingAshes/releases/download/V1.0/sysdata.rda"
tmp <- httr::GET(url,httr::write_disk(tempfile()), httr::progress("down"))
instdir <- system.file(package = 'RisingAshes')
tools:::sysdata2LazyLoadDB(tmp$content, file.path(instdir, "R"), compress = 3L)
detach(package:RisingAshes, unload=TRUE)
library(RisingAshes)
if(!require(devtools)) install.packages('devtools')
devtools:::install_github('famuvie/2016_RisingAshes')
library(RisingAshes)
browseVignettes('RisingAshes')  # vignettes
str(Devecey)
setwd("/Volumes/Mark Drive/NOLA/Mosquito Surveillance")
#Import data
#Gravid traps
grav <- read_excel("2020/Gravid/2020Gravid and pools.xlsx")
library(readr)
library(readxl)
library(ggplot2)
library(tidyr)
library(dplyr)
library(lubridate)
library(rgdal)
library(ggmap)
library(RColorBrewer)
library(viridisLite)
library(emoGG)
#Import data
#Gravid traps
grav <- read_excel("2020/Gravid/2020Gravid and pools.xlsx")
grav <- grav %>%
mutate(Date = as.Date(Date)) %>%
mutate_at(c(names(grav)[9:(ncol(grav)-1)]), as.integer) #Errors are OK, it's just warning that the "." were turned into NAs
grav <- mutate(grav, `Culex sp._total` = rowSums(grav[grep("Culex", names(grav))], na.rm = TRUE), `Aedes sp._total` = rowSums(grav[grep("Aedes", names(grav))], na.rm = TRUE))
#Subset to only the most recent week
grav_subset <- grav %>% filter(week(Date) == max(week(Date)))
View(grav_subset)
#Light traps
light <- rbind(read_excel("2020/CDC Light/2020CDCLTs.xlsx", sheet = 1), read_excel("2020/CDC Light/2020CDCLTs.xlsx", sheet = 2))
#Light traps
light <- rbind(read_excel("2020/CDC Light/2020CDCLTs.xlsx", sheet = 1), read_excel("2020/CDC Light/2020CDCLTs.xlsx", sheet = 2))
#Light traps
light <- rbind(read_excel("2020/CDC Light/2020CDCLTs.xlsx", sheet = 1), read_excel("2020/CDC Light/2020CDCLTs.xlsx", sheet = 2))
View(light)
light <- light %>%
mutate(Date = as.Date(Date)) %>%
mutate_at(c(names(light)[7:(ncol(light)-1)]), as.integer)
View(light)
light <- mutate(light, `Culex sp._total` = rowSums(light[grep("Culex", names(light))], na.rm = TRUE), `Aedes sp._total` = rowSums(light[grep("Aedes", names(light))], na.rm = TRUE))
#Subset to only the most recent week
light_subset <- light %>% filter(week(Date) == (max(week(Date))))
bg <- read_excel("2020/BG Sentinel/BG2020Data.xlsx")
View(bg)
bg <- bg %>%
mutate(Date = as.Date(Date)) %>%
mutate_at(c(names(bg)[7:(ncol(bg)-1)]), as.integer) #%>%
bg <- bg %>% mutate(`Culex sp._total` = rowSums(.[grep("Culex", names(.))], na.rm = TRUE), `Aedes sp._total` = rowSums(.[grep("Aedes", names(.))], na.rm = TRUE))
#Summarize by trap
#Custom function for the most frequently appearing string
calculate_mode <- function(x) {
uniqx <- unique(na.omit(x))
uniqx[which.max(tabulate(match(x, uniqx)))]
}
View(bg)
View(grav_subset)
View(light)
summ_grav <- grav_subset %>%
group_by(FID) %>%
summarize(address = calculate_mode(Address),
long = median(Long),
lat = median(Lat),
cul_total = sum(`Culex sp._total`, na.rm=T), #In case there are more than one observation per week, this calculate the total
cul_mean = mean(`Culex sp._total`, na.rm=T),
aed_total = sum(`Aedes sp._total`, na.rm=T),
aed_mean = mean(`Aedes sp._total`, na.rm=T))
summ_light <- light_subset %>%
group_by(Address) %>%
summarize(FID = mean(FID, na.rm = T),
long = median(long),
lat = median(lat),
cul_total = sum(`Culex sp._total`, na.rm=T),
cul_mean = mean(`Culex sp._total`, na.rm=T),
aed_total = sum(`Aedes sp._total`, na.rm=T),
aed_mean = mean(`Aedes sp._total`, na.rm=T))
summ_bg <- bg %>%
group_by(FID) %>%
summarize(address = calculate_mode(Address),
long = median(long),
lat = median(lat),
cul_total = sum(`Culex sp._total`, na.rm=T),
cul_mean = mean(`Culex sp._total`, na.rm=T),
aed_total = sum(`Aedes sp._total`, na.rm=T),
aed_mean = mean(`Aedes sp._total`, na.rm=T)) %>%
na.omit() #Get rid of superfluous NA row
View(bg)
summ_bg <- bg %>%
group_by(FID) %>%
summarize(address = calculate_mode(Address),
long = median(Long),
lat = median(Lat),
cul_total = sum(`Culex sp._total`, na.rm=T),
cul_mean = mean(`Culex sp._total`, na.rm=T),
aed_total = sum(`Aedes sp._total`, na.rm=T),
aed_mean = mean(`Aedes sp._total`, na.rm=T)) %>%
na.omit() #Get rid of superfluous NA row
View(summ_light)
